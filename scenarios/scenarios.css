/* =========================================
  MIRAHUB /scenarios - FINAL CSS (Unified with ../style.css)
  - HUB tokens: --surface/--surface-2/--border/--accent/--text/--muted ...
  - readable, consistent, modal scroll ok, trailer ok
========================================= */

:root{
  /* fallback (in case ../style.css is older) */
  --sc-text: var(--text, #e7eaf2);
  --sc-muted: var(--muted, rgba(231,234,242,.72));
  --sc-border: var(--border, rgba(255,255,255,.12));
  --sc-border2: var(--border-2, rgba(255,255,255,.18));
  --sc-surface: var(--surface, rgba(255,255,255,.04));
  --sc-surface2: var(--surface-2, rgba(255,255,255,.06));
  --sc-surface3: var(--surface-3, rgba(255,255,255,.08));
  --sc-accent: var(--accent, #8a7bff);
  --sc-accent2: var(--accent-2, #63d6ff);
  --sc-shadow: var(--shadow-2, 0 18px 70px rgba(0,0,0,.45));

  --sc-radius: 18px;
  --sc-radius-sm: 14px;
  --sc-radius-pill: 999px;

  --sc-focus: 0 0 0 4px rgba(138,123,255,.16);
}

/* base */
.sc-layout{ padding-bottom: 40px; }

.page-head{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap: 14px;
  margin-top: 18px;
}
.page-title{
  margin: 0;
  font-size: clamp(22px, 2.6vw, 34px);
  line-height: 1.12;
  letter-spacing: -0.02em;
}
.page-sub{ margin: 8px 0 0; }
.head-actions{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.sc-metaRow{
  padding: 10px 12px;
  border:1px dashed var(--sc-border);
  border-radius: 14px;
  background: rgba(255,255,255,.03);
}

/* Panel / Cards / Modal surfaces unified */
.panel,
.section-card,
.sc-card,
.modal-panel,
.confirm__panel{
  border: 1px solid var(--sc-border);
  border-radius: var(--sc-radius);
  background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  box-shadow: var(--sc-shadow);
}

.panel{ padding: 16px; }

/* ---------- Controls ---------- */
.controls-top{
  display:grid;
  grid-template-columns: 1.4fr 260px auto;
  gap: 12px;
  align-items:end;
}
.controls-grid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
  margin-top: 12px;
}
@media (max-width: 980px){
  .controls-top{ grid-template-columns: 1fr; }
  .controls-grid{ grid-template-columns: 1fr; }
}

/* fields */
.control{
  display:flex;
  flex-direction:column;
  gap: 6px;
}
.control-label{
  font-size: 12px;
  letter-spacing: .12em;
  color: var(--sc-muted);
  font-weight: 900;
}

/* force readable form styles (beats browser/../style.css) */
.controls .control input,
.controls .control select,
.panel .control input,
.panel .control select{
  width:100%;
  padding: 12px 12px;
  border-radius: 12px;
  border:1px solid var(--sc-border) !important;
  background: rgba(255,255,255,.06) !important;
  color: var(--sc-text) !important;
  outline:none;
  color-scheme: dark;
}
html[data-theme="light"] .controls .control input,
html[data-theme="light"] .controls .control select,
html[data-theme="light"] .panel .control input,
html[data-theme="light"] .panel .control select{
  color-scheme: light;
  background: rgba(15,23,42,.04) !important;
  color: var(--sc-text) !important;
}

.controls .control input:focus,
.controls .control select:focus,
.panel .control input:focus,
.panel .control select:focus{
  border-color: rgba(138,123,255,.40) !important;
  box-shadow: var(--sc-focus);
}

/* select arrow */
.control select{
  appearance:none;
  background-image:
    linear-gradient(45deg, transparent 50%, rgba(231,234,242,.72) 50%),
    linear-gradient(135deg, rgba(231,234,242,.72) 50%, transparent 50%);
  background-position:
    calc(100% - 18px) 50%,
    calc(100% - 12px) 50%;
  background-size: 6px 6px, 6px 6px;
  background-repeat:no-repeat;
  padding-right: 36px;
}
html[data-theme="light"] .control select{
  background-image:
    linear-gradient(45deg, transparent 50%, rgba(15,23,42,.55) 50%),
    linear-gradient(135deg, rgba(15,23,42,.55) 50%, transparent 50%);
}

/* options (works on many envs) */
.controls .control select option,
.panel .control select option{
  background: #0b0d12;
  color: #e7eaf2;
}
html[data-theme="light"] .controls .control select option,
html[data-theme="light"] .panel .control select option{
  background: #ffffff;
  color: #0f172a;
}

/* toggles */
.toggles{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.toggle{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.04);
  color: var(--sc-muted);
  cursor:pointer;
  user-select:none;
}
.toggle input{ accent-color: var(--sc-accent); }
.toggle:hover{
  color: var(--sc-text);
  border-color: rgba(138,123,255,.28);
  background: rgba(138,123,255,.10);
}

/* tags */
.tags-area{
  margin-top: 14px;
  border-top: 1px dashed rgba(255,255,255,.10);
  padding-top: 14px;
}
.tags-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: 12px;
}
.tag-actions{ display:flex; gap: 10px; flex-wrap:wrap; }
.chip-btn{
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.03);
  color: var(--sc-muted);
  padding: 8px 10px;
  border-radius: 12px;
  cursor:pointer;
}
.chip-btn:hover{
  color: var(--sc-text);
  border-color: rgba(138,123,255,.30);
  background: rgba(138,123,255,.10);
}
.tags-input-row{ margin-top: 10px; }
.tags-input-row input{
  width:100%;
  padding: 12px 12px;
  border-radius: 12px;
  border:1px solid var(--sc-border) !important;
  background: rgba(255,255,255,.06) !important;
  color: var(--sc-text) !important;
  outline:none;
}
.tags-input-row input:focus{
  border-color: rgba(138,123,255,.40) !important;
  box-shadow: var(--sc-focus);
}
.chips{
  display:flex;
  flex-wrap:wrap;
  gap: 8px;
  margin-top: 10px;
}
.chips.selected{ margin-top: 12px; }

.sc-pill{
  font-size: 12px;
  padding: 6px 10px;
  border-radius: var(--sc-radius-pill);
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.05);
  color: var(--sc-muted);
}
.sc-tag{
  cursor:pointer;
}
.sc-tag:hover{
  color: var(--sc-text);
  border-color: rgba(138,123,255,.28);
}
.sc-tag.is-selected{
  border-color: rgba(138,123,255,.40);
  background: rgba(138,123,255,.16);
  color: var(--sc-text);
}

/* ---------- View tabs ---------- */
.sc-view-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
}
.sc-tabs{
  display:flex;
  gap: 10px;
}
.sc-tab{
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.03);
  color: var(--sc-muted);
  padding: 10px 12px;
  border-radius: var(--sc-radius-pill);
  cursor:pointer;
}
.sc-tab:hover{
  color: var(--sc-text);
  border-color: rgba(138,123,255,.28);
}
.sc-tab.is-active{
  color: var(--sc-text);
  border-color: rgba(138,123,255,.40);
  background: rgba(138,123,255,.16);
}

/* ---------- Cards ---------- */
.sc-cards{
  display:grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 14px;
}
@media (max-width: 980px){
  .sc-cards{ grid-template-columns: 1fr; }
}

body.is-compact .sc-note{ display:none; }

.sc-card{
  padding: 14px 14px 12px;
  position:relative;
  overflow:hidden;
  transition: transform .18s ease, border-color .18s ease, box-shadow .18s ease;
}
.sc-card:hover{
  transform: translateY(-2px);
  border-color: var(--sc-border2);
}

.sc-id{
  position:absolute;
  top:12px;
  right:12px;
  font-size: 11px;
  letter-spacing:.12em;
  color: var(--sc-muted);
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.06);
  padding: 4px 8px;
  border-radius: var(--sc-radius-pill);
}

.sc-title{
  font-weight: 950;
  font-size: 16px;
  line-height:1.25;
  margin-right: 64px;
  color: var(--sc-text);
}

.sc-pillRow{
  display:flex;
  flex-wrap:wrap;
  gap: 8px;
  margin-top: 10px;
}

.sc-note{
  margin-top: 10px;
  color: var(--sc-muted);
  line-height: 1.7;
  font-size: 13px;
  padding-top: 10px;
  border-top: 1px dashed rgba(255,255,255,.10);
  white-space: pre-wrap;
}

.sc-actions{
  display:flex;
  gap:10px;
  margin-top: 10px;
  justify-content:flex-end;
}
.sc-icon{
  width: 40px;
  height: 40px;
  border-radius: 12px;
  border: 1px solid var(--sc-border);
  background: rgba(255,255,255,.04);
  color: var(--sc-text);
  cursor:pointer;
  display:grid;
  place-items:center;
}
.sc-icon:hover{
  border-color: rgba(138,123,255,.30);
  background: rgba(138,123,255,.10);
}

/* loss + R18 */
.loss-low{ border-color: rgba(126,240,200,.30); color: rgba(126,240,200,.95); }
.loss-mid{ border-color: rgba(255,200,90,.30); color: rgba(255,220,140,.95); }
.loss-high{ border-color: rgba(255,90,122,.30); color: rgba(255,120,150,.95); }
.loss-very{ border-color: rgba(255,60,90,.48); color: rgba(255,90,122,.95); background: rgba(255,90,122,.10); }

.sc-r18{
  border-color: rgba(255,77,109,.48);
  background: rgba(255,77,109,.14);
  color: rgba(255,77,109,.96);
  font-weight: 950;
}

/* ---------- Table ---------- */
.sc-tableWrap{
  overflow:auto;
  border:1px solid var(--sc-border);
  border-radius: var(--sc-radius-sm);
}
.sc-table{
  width:100%;
  border-collapse: collapse;
  font-size: 13px;
}
.sc-table thead th{
  color: var(--sc-text);
  text-align:left;
  background: rgba(255,255,255,.06);
  border-bottom: 1px solid var(--sc-border);
  padding: 10px 10px;
  position: sticky;
  top: 0;
}
.sc-table td{
  padding: 10px 10px;
  border-bottom: 1px solid rgba(255,255,255,.08);
  color: var(--sc-muted);
  white-space: nowrap;
}
.sc-link-btn{
  border:1px solid var(--sc-border);
  background: rgba(255,255,255,.03);
  color: var(--sc-text);
  padding: 6px 10px;
  border-radius: 10px;
  cursor:pointer;
}
.sc-link-btn:hover{
  border-color: rgba(138,123,255,.30);
  background: rgba(138,123,255,.10);
}

/* ---------- Modals ---------- */
.modal{
  position: fixed;
  inset:0;
  display:none;
  z-index: 999;
  overflow:auto;
  overscroll-behavior: contain;
}
.modal.is-show{ display:block; }

.modal-backdrop{
  position:absolute;
  inset:0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(12px);
}

.modal-panel{
  position: relative;
  width: min(980px, calc(100% - 28px));
  margin: 6vh auto;
  padding: 16px 18px;
  max-height: 88vh;
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  color: var(--sc-text);
}
html[data-theme="light"] .modal-panel{
  background: linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.86));
}

.modal-top{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 12px;
  position: sticky;
  top: 0;
  padding: 8px 0 12px;
  background: linear-gradient(180deg, rgba(0,0,0,.22), transparent);
  backdrop-filter: blur(6px);
  z-index: 2;
}
html[data-theme="light"] .modal-top{
  background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.0));
}
.modal-title{
  font-weight: 950;
  font-size: 18px;
  letter-spacing: -0.01em;
}
.modal-sub{ margin-top: 6px; font-size: 13px; }

.modal-close{
  width: 40px;
  height: 40px;
  border-radius: 12px;
  border: 1px solid var(--sc-border);
  background: rgba(255,255,255,.04);
  color: var(--sc-text);
  cursor:pointer;
  display:grid;
  place-items:center;
}
.modal-close:hover{
  border-color: rgba(138,123,255,.30);
  background: rgba(138,123,255,.10);
}

/* zoom */
.modal-zoom{
  width: min(1200px, calc(100% - 28px));
  padding: 12px;
  overflow:hidden;
}
.modal-zoom img{
  width:100%;
  height:auto;
  display:block;
  max-height: 84vh;
  object-fit: contain;
  background: rgba(0,0,0,.18);
  border-radius: 14px;
}

/* detail blocks */
.detail-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 12px;
}
@media (max-width: 760px){
  .detail-grid{ grid-template-columns: 1fr; }
}
.detail-block{
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  border-radius: var(--sc-radius-sm);
  padding: 12px;
}
html[data-theme="light"] .detail-block{
  border: 1px solid rgba(15,23,42,.10);
  background: rgba(15,23,42,.04);
}
.detail-block h3{
  margin: 0;
  font-size: 12px;
  letter-spacing: .10em;
  color: rgba(255,255,255,.72);
}
html[data-theme="light"] .detail-block h3{
  color: rgba(15,23,42,.72);
}
.detail-val{
  margin-top: 8px;
  color: var(--sc-text);
  font-weight: 800;
}
.detail-val .muted{
  color: var(--sc-muted);
  font-weight: 700;
}
.detail-memo{
  white-space: pre-wrap;
  line-height: 1.75;
  color: var(--sc-muted);
  font-weight: 700;
}
.detail-actions{
  display:flex;
  gap: 10px;
  flex-wrap:wrap;
  align-items:center;
}

/* trailer carousel */
.trailer{
  margin-top: 10px;
}
.trailer-viewport{
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  border: 1px solid var(--sc-border);
  background: rgba(0,0,0,.16);
  max-height: 56vh;
}
.trailer-viewport img{
  width:100%;
  max-height: 56vh;
  object-fit: contain;
  display:block;
  cursor: zoom-in;
}
.trailer-nav{
  position:absolute;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  pointer-events:none;
}
.trailer-btn{
  pointer-events:auto;
  width: 44px;
  height: 44px;
  margin: 0 10px;
  border-radius: 14px;
  border: 1px solid var(--sc-border);
  background: rgba(0,0,0,.28);
  color: var(--sc-text);
  cursor:pointer;
  display:grid;
  place-items:center;
}
.trailer-btn:hover{
  border-color: rgba(138,123,255,.30);
  background: rgba(138,123,255,.16);
}
.trailer-dots{
  display:flex;
  gap: 8px;
  justify-content:center;
  margin-top: 10px;
}
.trailer-dot{
  width: 9px;
  height: 9px;
  border-radius: 999px;
  background: rgba(255,255,255,.24);
  border: 1px solid rgba(255,255,255,.16);
  cursor:pointer;
}
.trailer-dot.is-active{
  background: rgba(138,123,255,.55);
  border-color: rgba(138,123,255,.35);
}

/* ---------- Confirm ---------- */
.confirm{
  position: fixed;
  inset:0;
  display:none;
  z-index: 1000;
}
.confirm.is-show{ display:block; }

.confirm__backdrop{
  position:absolute;
  inset:0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(12px);
}
.confirm__panel{
  position: relative;
  width: min(560px, calc(100% - 28px));
  margin: 12vh auto;
  padding: 16px 18px;
}
html[data-theme="light"] .confirm__panel{
  background: linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.86));
}

.confirm__title{
  font-weight: 950;
  letter-spacing:.12em;
  font-size: 12px;
  color: rgba(255,255,255,.70);
}
html[data-theme="light"] .confirm__title{
  color: rgba(15,23,42,.70);
}
.confirm__text{ margin-top: 10px; line-height: 1.7; color: var(--sc-text); }
.confirm__check{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top: 14px;
  color: var(--sc-muted);
  font-size: 13px;
}
.confirm__actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top: 16px;
}

/* ---------- Toast ---------- */
.toast-host{
  position: fixed;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%);
  display:flex;
  flex-direction:column;
  gap: 10px;
  z-index: 1100;
  width: min(520px, calc(100% - 28px));
  pointer-events:none;
}
.toast{
  pointer-events:none;
  padding: 10px 12px;
  border-radius: var(--sc-radius-pill);
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(10,14,26,.78);
  color: var(--sc-text);
  box-shadow: var(--sc-shadow);
  opacity:0;
  transform: translateY(6px);
  transition: opacity .15s ease, transform .15s ease;
}
.toast.is-show{
  opacity:1;
  transform: translateY(0);
}

/* scrollbars (less ugly) */
.modal-panel::-webkit-scrollbar{ width: 10px; }
.modal-panel::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.18);
  border: 2px solid rgba(0,0,0,0);
  background-clip: padding-box;
  border-radius: 999px;
}
.modal-panel::-webkit-scrollbar-track{
  background: rgba(255,255,255,.06);
  border-radius: 999px;
}
.modal-panel{
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,.18) rgba(255,255,255,.06);
}